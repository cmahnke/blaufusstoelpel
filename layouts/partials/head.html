<head>
  <meta charset="utf-8">
  <title>{{ .Site.Title }}</title>

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  {{ partial "html/head/meta.html" . }}

  {{ range .Site.Params.plugins.css }}
  <link rel="stylesheet" href="{{ .link | absURL }} ">
  {{ end }}

  {{- $options := (dict "targetPath" "base.css" "outputStyle" "compressed" "includePaths" (slice "node_modules/ol" "node_modules/slick-carousel/slick" "node_modules/bootstrap/scss" )) -}}
  {{- $scssTemplate := resources.Get "scss/base.scss" -}}
  {{- $scssStyle := $scssTemplate | resources.ExecuteAsTemplate "scss/base.scss" . | toCSS $options -}}
  {{- $style := slice  $scssStyle | resources.Concat "css/concated.css" | minify  | fingerprint -}}
  <link href="{{ $style.RelPermalink }}" rel="stylesheet" integrity="{{ $style.Data.Integrity }}">

  {{/* JavaScript */}}
  {{- $defines := dict "process.env.NODE_ENV" `"production"` -}}
  {{- $mainOpts := dict "targetPath" "js/main.js" "defines" $defines "minify" false -}}
  {{- $main := resources.Get "js/main.js" | js.Build $mainOpts -}}

  {{- $mainJs := "" -}}
  {{- if or .IsHome (hasPrefix .Page.Params.iiifcontext "http://iiif.io/api/image/") -}}
      {{- $iiifOpts := dict "targetPath" "js/iiif-image-viewer.js" "defines" $defines "minify" false -}}
      {{- $iiif := resources.Get "js/iiif-image-viewer.js" | js.Build $iiifOpts -}}
      {{- $mainJs = slice $main $iiif | resources.Concat "js/main-iiif-i.js" | minify | fingerprint -}}
  {{- else if (hasPrefix .Page.Params.iiifcontext "http://iiif.io/api/presentation/") -}}
      {{- $iiifOpts := dict "targetPath" "js/iiif-presentation-viewer.js" "defines" $defines "minify" false -}}
      {{- $iiif := resources.Get "js/iiif-presentation-viewer.js" | js.Build $iiifOpts -}}
      {{- $mainJs = slice $main $iiif | resources.Concat "js/main-iiif-p.js" | minify | fingerprint -}}
  {{- else -}}
      {{- $mainJs = slice $main | resources.Concat "js/main.js" | minify | fingerprint -}}
  {{- end -}}
  <script src="{{ $mainJs.RelPermalink }}" integrity="{{ $mainJs.Data.Integrity }}"></script>

  <link rel="shortcut icon" href="{{ `images/favicon.png` | absURL }} " type="image/x-icon">
  <link rel="icon" href="{{ `images/favicon.png` | absURL }} " type="image/x-icon">
  {{ range .AlternativeOutputFormats -}}
    {{ printf `<link rel="%s" type="%s" href="%s" title="%s" />` .Rel .MediaType.Type .Permalink $.Site.Title | safeHTML }}
  {{ end -}}

</head>
