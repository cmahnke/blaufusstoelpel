<div class="col-lg-4">
  <div class="widget">
    <h6 class="mb-4">{{ i18n "latestPosts" }}</h6>
    {{ range first 3 ( where .Site.RegularPages "Type" "post") }}
    <div class="media mb-4">
      <div class="post-thumb-sm mr-3">
          {{- $context := path.Dir .File.Path -}}
          {{- $images := newScratch -}}
          {{- $entry := . -}}

          {{- range .Params.resources -}}
              {{- if eq .name "front" -}}
                  {{- $images.Set "previewLoc" (path.Join $context .src) -}}
                  {{- $images.Set "preview" (($entry.Resources.ByType "image").GetMatch .name) -}}
              {{ end }}
          {{ end }}

          {{- $imgLocation := $images.Get "previewLoc" -}}
          {{- $previewImg := $images.Get "preview" -}}
          {{- if eq $previewImg nil -}}
              {{- warnf "Can't find image %s for post %s" $imgLocation $context -}}
          {{- end -}}
          {{- $previewImg = $previewImg.Resize "90x"  -}}

        <a href="{{ .Permalink }}"><img class="mr-3 post-thumb-sm" src="{{ $previewImg.RelPermalink }}"></a>
      </div>
      <div class="media-body">
        <ul class="list-inline d-flex justify-content-between mb-2">
          <li class="list-inline-item">{{ i18n "postedBy" }} {{.Site.Params.author}}</li>
          <li class="list-inline-item">{{- partial "date.html" (dict "date" .Date "language" $.Page.Language "months" $.Site.Data.months) -}}</li>
        </ul>
        <h6><a class="text-dark" href="{{ .Permalink }}">{{.Title}}</a></h6>
      </div>
    </div>
    {{ end }}
  </div>
  <div class="widget">
    <h6 class="mb-4">{{ i18n "tags" }}</h6>
    {{- if isset .Site.Taxonomies "tags" }}
    {{- if not (eq (len .Site.Taxonomies.tags) 0) }}
    <ul class="list-inline tag-list">
      {{- range $name, $items := .Site.Taxonomies.tags }}
      <li class="list-inline-item m-1"><a href="{{ "tags/" | relLangURL }}{{ $name | urlize | lower }}">{{ partial "tag.html" (dict "tag" $name) }}</a></li>
      {{- end }}
    </ul>
    {{- end }}
    {{- end }}
  </div>
  <div class="widget">
    <h6 class="mb-4">{{ i18n "categories" }}</h6>
    {{- if isset .Site.Taxonomies "categories" }}
    {{- if not (eq (len .Site.Taxonomies.categories) 0) }}
    <ul class="list-inline tag-list">
      {{- range $name, $items := .Site.Taxonomies.categories }}
      <li class="list-inline-item m-1"><a href="{{ "categories/" | relLangURL }}{{ $name | urlize | lower }}">{{ $name | title | humanize }}</a></li>
      {{- end }}
    </ul>
    {{- end }}
    {{- end }}
  </div>
</div>
